<ion-view>

    <ion-header-bar  class="bar-calm" ng-if="!bulkMode" align-title="center" on-tap="scrollTop()">
        <div class="buttons">
            <button class="button button-icon icon ion-navicon" menu-toggle="left"></button>
        </div>
        <h1 class="title">Messages {{info.count}} / {{info.lastCount}}</h1>
        <div class="buttons">
            <button class="button button-icon icon ion-search" menu-toggle="right"></button>
        </div>
    </ion-header-bar>

    <ion-header-bar class="bar-assertive" ng-if="bulkMode" align-title="center">

        <div class="buttons">
            <button class="button button-clear" on-tap="toggleBulkSelect()">
                <i class="icon ion-checkmark-round"
                   ng-class="{'ion-ios-checkmark-outline': info.count != selectedCount, 'ion-ios-circle-outline': info.count == selectedCount}"></i>
                {{selectedCount}}/{{info.count}}
            </button>
        </div>

        <div class="title">&nbsp;</div>

        <div class="buttons se-bar-actions">
            <button class="button {{::action.cssClass}}"  on-tap="processAction(action)" ng-repeat="action in barActions">
                <i class="icon {{::action.icon}}"></i>
            </button>
            <button class="button" on-tap="processAction('', $event)">
                <i class="icon ion-more"></i>
            </button>
        </div>
    </ion-header-bar>

    <ion-content class="has-header">
        <div message-queue></div>

        <ion-refresher pulling-text="Release me" on-refresh="pullToRefresh()"></ion-refresher>

        <ion-list>
            <ion-item class="text-center" ng-if="!loadingEntries && !messageEntries.length">
                No entries. Pull to refresh...
            </ion-item>
            <ion-item
                    class="item-avatar-left"
                    ng-class="{grayedout: message.isChecked}"
                    collection-repeat="message in messageEntries"
                    on-hold="selectEntry($index)"
                    on-tap="openMessage(message)"
            >
                <div se-checkbox></div>
                <h2>{{::message['decoded_subject_header']}}</h2>
                <p>{{::message['classification']}} - {{::message['classification_details']}}</p>
            </ion-item>
        </ion-list>

        <ion-infinite-scroll
                ng-if="!noMoreItemsAvailable"
                on-infinite="infiniteScroll()"
                distance="10%"
        >
        </ion-infinite-scroll>
    </ion-content>
</ion-view>